<section id="section-{{section.reference}}" class="sg sg-section"
  ng-class="{active: isActive(section), main: isEmptyMainSection(section)}">
  <header class="sg sg-section-header">
    <a ui-sref="app.index.section({section: '{{section.reference}}'})">
      <i class="fa fa-link"></i>
      <h1 class="sg">
        <span class="sg-reference-number">{{ section.reference }}</span>
        <span ng-bind-html="section.header | unsafe"></span>
        <span class="sg-section-source">{{ section.file }}</span>
      </h1>
    </a>
    <nav class="ny-sg-section-menu">
      <a class="ny-sg-section-menu-button"
              ng-class="{'active' : section.showDescription}"
              ng-click="section.showDescription = !section.showDescription">desc</a>
      <a class="ny-sg-section-menu-button"
              ng-class="{'active' : section.showCSS}"
              ng-click="section.showCSS = !section.showCSS">css</a>
      <a class="ny-sg-section-menu-button"
              ng-class="{'active' : section.showMarkup}"
              ng-click="section.showMarkup = !section.showMarkup">html</a>
    </nav>
  </header>
  <div ng-repeat-start="mod in section.modifiers"></div>
  <div class="sg sg-section-partial sg-section-style">
    <span class="sg sg-name" ng-bind-html="mod.name | unsafe"></span>
    <shadow-dom id="section-{{section.reference}}-modifier-{{mod.id}}-render-markup">
      <div ng-bind-html="mod.renderMarkup | setModifierClass: mod.className | setVariables: variables | addWrapper | unsafe" dynamic-compile></div>
    </shadow-dom>
    <div class="sg sg-label">
      <a ui-sref="app.fullscreen({section: '{{section.reference}}-{{mod.id}}'})" target="_blank">
        <i class="fa fa-arrows-alt"></i>
      </a>
    </div>
  </div>
  <div ng-repeat-end></div>

  <div class="sg sg-section-partial sg-code-description"
       ng-if="section.modifiers.length || section.description"
       ng-init="section.showDescription = !(section.modifiers && section.modifiers.length > 0)"
       ng-show="section.showDescription">
    <p class="sg sg-section-description" ng-bind-html="section.description | unsafe"></p>
    <ul ng-if="section.modifiers.length" class="sg modifier-list">
      <li class="sg-item" ng-repeat="mod in section.modifiers">
        <strong ng-bind-html="mod.name | unsafe"></strong> - <span ng-bind-html="mod.description | unsafe"></span>
      </li>
    </ul>
  </div>

  <div
    class="sg sg-section-partial"
    ng-if="!section.modifiers.length && section.markup">
    <div class="sg sg-label">
      <a ui-sref="app.fullscreen({section: '{{section.reference}}'})" target="_blank">
        <i class="fa fa-arrows-alt"></i>
      </a>
    </div>

    <shadow-dom id="section-{{section.reference}}-render-markup">
      <div ng-bind-html="section.renderMarkup | setVariables: variables | addWrapper | unsafe" dynamic-compile></div>
    </shadow-dom>
  </div>

  <div class="sg sg-section-partial sg-code-listing" ng-if="section.css && section.showCSS">
    <div class="sg sg-label">
      <a ng-click="section.showCSS = false" target="_blank">
        <i class="fa fa-close"></i>
      </a>
    </div>
    <pre class="sg" ng-if="section.showCSS"><code hljs source="section.css" class="html"></code></pre>
  </div>

  <div class="sg sg-section-partial sg-code-listing" ng-if="section.markupJade">
    <div ng-if="section.showMarkupJade" class="sg sg-label">
      <a ng-click="section.showMarkupJade = false" target="_blank">
        <i class="fa fa-close"></i>
      </a>
    </div>
    <pre class="sg" ng-if="section.showMarkupJade"><code hljs source="section.markupJade" class="css"></code></pre>
    <a class="sg sg-show-section" ng-hide="section.showMarkupJade" ng-click="section.showMarkupJade = true">Show JADE markup</a>
  </div>

  <div class="sg sg-section-partial sg-code-listing"
       ng-init="section.showMarkup = false"
       ng-if="section.markup" ng-show="section.showMarkup">
    <div class="sg sg-label">
      <a ng-click="section.showMarkup = false" target="_blank">
        <i class="fa fa-close"></i>
      </a>
    </div>
    <pre class="sg" ng-if="section.showMarkup"><code hljs source="section.markup" class="css"></code></pre>
  </div>
</section>
